when analyzing the source code of the program, we see that it grant a shell if the auth function return 0
to do that, we need to provide a login that is superior to 5 printable characters, and his corresponding serial
we'll use the login "abcdef", the auth function take the 4th character in the login string (so 'd' / 100)
it is XORed with 0x1337 (4919 in decimal) and added to 6221293, that makes 6226200, this is the base number
then, for each character of login, there is a XOR operation with the ASCII value of the character, then taken modulo 0x539 (1337 in decimal) like :
'a' (ASCII 97): v4 = 6226200 + (6226200 ^ 97) % 1337 = 6227066
'b' (ASCII 98): v4 = 6227066 + (6227066 ^ 98) % 1337 = 6227930
'c' (ASCII 99): v4 = 6227930 + (6227930 ^ 99) % 1337 = 6228791
'd' (ASCII 100): v4 = 6228791 + (6228791 ^ 100) % 1337 = 6229654
'e' (ASCII 101): v4 = 6229654 + (6229654 ^ 101) % 1337 = 6230520
'f' (ASCII 102): v4 = 6230520 + (6230520 ^ 102) % 1337 = 6232802
so, for the login "abcdef", the serial is 6232802, when we enter those informations we get a setuid shell
